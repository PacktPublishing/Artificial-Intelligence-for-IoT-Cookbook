{"version":"NotebookV1","origId":313890538218837,"name":"Chemical Sensor Decision Tree","language":"python","commands":[{"version":"CommandV1","origId":313890538218838,"guid":"746823c5-719c-4339-baab-0ab362b63929","subtype":"command","commandType":"auto","position":1.0,"command":"import databricks.koalas as pd\nimport numpy as np\n\nfrom sklearn import neighbors, metrics\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier \nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import LabelEncoder\n\n","commandVersion":51,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1575330210994,"submitTime":1575330210969,"finishTime":1575330211183,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"v-roshmi@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"e80c8e72-4e6e-4430-9c96-34d3446a43de"},{"version":"CommandV1","origId":313890538218839,"guid":"b4f7747b-665d-4c3b-8788-107ee7ecab09","subtype":"command","commandType":"auto","position":2.0,"command":"df = spark.sql(\"select * from ChemicalSensor where class <> 'banana'\")\npdf = df.toPandas()","commandVersion":6,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"integer"},{"metadata":{},"name":"r1","nullable":true,"type":"double"},{"metadata":{},"name":"r2","nullable":true,"type":"double"},{"metadata":{},"name":"r3","nullable":true,"type":"double"},{"metadata":{},"name":"r4","nullable":true,"type":"double"},{"metadata":{},"name":"r5","nullable":true,"type":"double"},{"metadata":{},"name":"r6","nullable":true,"type":"double"},{"metadata":{},"name":"r7","nullable":true,"type":"double"},{"metadata":{},"name":"r8","nullable":true,"type":"double"},{"metadata":{},"name":"temp","nullable":true,"type":"double"},{"metadata":{},"name":"humidity","nullable":true,"type":"double"},{"metadata":{},"name":"class","nullable":true,"type":"string"},{"metadata":{},"name":"t0","nullable":true,"type":"double"},{"metadata":{},"name":"td","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}]},"errorSummary":null,"error":null,"workflows":[],"startTime":1575330212635,"submitTime":1575330212612,"finishTime":1575330213951,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"v-roshmi@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"59aa81e6-628b-4cd3-a48d-4b1ce014eecf"},{"version":"CommandV1","origId":313890538218840,"guid":"1368f766-e8c2-4e33-ab34-c0eb79605b16","subtype":"command","commandType":"auto","position":3.0,"command":"\n\npdf.rename(columns = {'class':'classification'}, inplace = True) \n\n\nlabel_encoder = LabelEncoder()\ninteger_encoded = label_encoder.fit_transform(pdf['classification'])\nonehot_encoder = OneHotEncoder(sparse=False)\n\ninteger_encoded = integer_encoded.reshape(len(integer_encoded), 1)\nonehot_encoded = onehot_encoder.fit_transform(integer_encoded)\n\nfeature_cols = [ 'r4','r5' , 'td']\nX = pdf[feature_cols]\ny = onehot_encoded\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=5)\n\nprint (y)","commandVersion":68,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">/databricks/python/lib/python3.7/site-packages/sklearn/preprocessing/_encoders.py:371: FutureWarning: The handling of integer data will change in version 0.22. Currently, the categories are determined based on the range [0, max(values)], while in the future they will be determined based on the unique values.\nIf you want the future behaviour and silence this warning, you can specify &#34;categories=&#39;auto&#39;&#34;.\nIn case you used a LabelEncoder before this OneHotEncoder to convert the categories to integers, then you can now use the OneHotEncoder directly.\n  warnings.warn(msg, FutureWarning)\n[[1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [1. 0.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]\n [0. 1.]]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1575330549721,"submitTime":1575330549699,"finishTime":1575330549809,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"v-roshmi@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"3dc1bd5a-65a1-4caf-a523-99418ef7bbd5"},{"version":"CommandV1","origId":313890538218841,"guid":"805c7455-05d0-4c58-ab89-fb43486ccba7","subtype":"command","commandType":"auto","position":4.0,"command":"# Create Decision Tree classifer object\nclf = DecisionTreeClassifier()\n\n# Train Decision Tree Classifer\nclf = clf.fit(X_train,y_train)\n\n#Predict the response for test dataset\ny_pred = clf.predict(X_test)","commandVersion":3,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1575330739197,"submitTime":1575330739097,"finishTime":1575330739212,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"v-roshmi@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"a6cc96fb-718b-42f6-ad46-04aa2fca465b"},{"version":"CommandV1","origId":313890538218842,"guid":"43fb586c-cf8b-438c-8e4f-f078f5a1a96c","subtype":"command","commandType":"auto","position":5.0,"command":"print(\"Accuracy:\",metrics.accuracy_score(y_test, y_pred))\nprint(\"AUC:\",roc_auc_score(y_test, y_pred))","commandVersion":2,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Accuracy: 0.8571428571428571\nAUC: 0.875\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1575330740263,"submitTime":1575330740239,"finishTime":1575330740278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"v-roshmi@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"bc8fe8b0-3add-4d7c-aa3b-b6e8ec6a835d"},{"version":"CommandV1","origId":1744096882587805,"guid":"9d772ab4-18d7-47a1-b7af-ed5832adae27","subtype":"command","commandType":"auto","position":11.0,"command":"print(\"Accuracy:\",metrics.accuracy_score(y_test, y_pred))\nprint(\"AUC:\",roc_auc_score(y_test, y_pred))","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Accuracy: 0.7142857142857143\nAUC: 0.7291666666666667\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1575331158884,"submitTime":1575331158858,"finishTime":1575331158899,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"v-roshmi@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"40c1f259-1a13-42ff-9d42-d10dd3739a22"},{"version":"CommandV1","origId":1744096882587806,"guid":"87dd1975-ae9e-4971-ac80-64738551d1dd","subtype":"command","commandType":"auto","position":8.0,"command":"clf=RandomForestClassifier(n_estimators=100)\n\n#Train the model using the training sets y_pred=clf.predict(X_test)\nclf.fit(X_train,y_train)\n\ny_pred=clf.predict(X_test)","commandVersion":1,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1575331147465,"submitTime":1575331147368,"finishTime":1575331147571,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"v-roshmi@microsoft.com","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"86cb91a4-1fde-4bba-95db-7f450b18d8d6"},{"version":"CommandV1","origId":1744096882587807,"guid":"f00ec1ae-ea0b-4d51-a02c-050af8825d12","subtype":"command","commandType":"auto","position":12.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"nuid":"be962d6f-b2cd-4b40-b8d6-c29d985366ad"}],"dashboards":[],"guid":"99df4b35-2a59-4d43-96b5-f40c3b08e8f3","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}}